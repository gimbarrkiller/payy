import{_ as ne}from"./angle-right_blue.3c01ebe8.js";import{ae,o as Ut,d as Kt,f as jt,b as se,z as le,e as ce,c as ue,E as he,H as fe,u as gt,i as st,v as de,t as mt,j as ge,q as pe,af as Mt,O as ve,p as me}from"./gpb-new.9481ec94.js";import{_ as ye}from"./plugin-vue_export-helper.21dcd24c.js";import{u as be}from"./usePaymentAvailability.27b8d1fe.js";import"./useLoader.013ecf08.js";function kt(n){return n===""?n:n==="true"||n=="1"}function we(n,e){return new Promise((t,r)=>{var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var o=new FileReader;o.onloadend=function(){t(o.result)},o.readAsArrayBuffer(i.response)},i.open("GET",n),i.send()})}var rt=function(n,e){return Object.assign(document.createElement("canvas"),{width:n,height:e})},Xt={},ct={};Object.defineProperty(ct,"__esModule",{value:!0});ct.loop=ct.conditional=Zt=ct.parse=void 0;var Be=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(t))t.forEach(function(a){return n(e,a,r,i)});else if(typeof t=="function")t(e,r,i,n);else{var o=Object.keys(t)[0];Array.isArray(t[o])?(i[o]={},n(e,t[o],r,i[o])):i[o]=t[o](e,r,i,n)}return r},Zt=ct.parse=Be,Ce=function(e,t){return function(r,i,o,a){t(r,i,o)&&a(r,e,i,o)}};ct.conditional=Ce;var xe=function(e,t){return function(r,i,o,a){for(var c=[],l=r.pos;t(r,i,o);){var f={};if(a(r,e,i,f),r.pos===l)break;l=r.pos,c.push(f)}return c}};ct.loop=xe;var K={};Object.defineProperty(K,"__esModule",{value:!0});K.readBits=K.readArray=K.readUnsigned=K.readString=K.peekBytes=K.readBytes=K.peekByte=K.readByte=Jt=K.buildStream=void 0;var Pe=function(e){return{data:e,pos:0}},Jt=K.buildStream=Pe,Vt=function(){return function(e){return e.data[e.pos++]}};K.readByte=Vt;var ke=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(t){return t.data[t.pos+e]}};K.peekByte=ke;var Ct=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};K.readBytes=Ct;var Ee=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};K.peekBytes=Ee;var Te=function(e){return function(t){return Array.from(Ct(e)(t)).map(function(r){return String.fromCharCode(r)}).join("")}};K.readString=Te;var Ae=function(e){return function(t){var r=Ct(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};K.readUnsigned=Ae;var _e=function(e,t){return function(r,i,o){for(var a=typeof t=="function"?t(r,i,o):t,c=Ct(e),l=new Array(a),f=0;f<a;f++)l[f]=c(r);return l}};K.readArray=_e;var Se=function(e,t,r){for(var i=0,o=0;o<r;o++)i+=e[t+o]&&Math.pow(2,r-o-1);return i},De=function(e){return function(t){for(var r=Vt()(t),i=new Array(8),o=0;o<8;o++)i[7-o]=!!(r&1<<o);return Object.keys(e).reduce(function(a,c){var l=e[c];return l.length?a[c]=Se(i,l.index,l.length):a[c]=i[l.index],a},{})}};K.readBits=De;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=ct,t=K,r={blocks:function(d){for(var P=0,A=[],I=d.data.length,H=0,p=(0,t.readByte)()(d);p!==P&&p;p=(0,t.readByte)()(d)){if(d.pos+p>=I){var u=I-d.pos;A.push((0,t.readBytes)(u)(d)),H+=u;break}A.push((0,t.readBytes)(p)(d)),H+=p}for(var C=new Uint8Array(H),h=0,w=0;w<A.length;w++)C.set(A[w],h),h+=A[w].length;return C}},i=(0,e.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(g){var d=(0,t.peekBytes)(2)(g);return d[0]===33&&d[1]===249}),o=(0,e.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,t.readArray)(3,function(g,d,P){return Math.pow(2,P.descriptor.lct.size+1)})},function(g,d,P){return P.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},r]}]},function(g){return(0,t.peekByte)()(g)===44}),a=(0,e.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(d,P,A){return(0,t.readBytes)(A.text.blockSize)(d)}},r]},function(g){var d=(0,t.peekBytes)(2)(g);return d[0]===33&&d[1]===1}),c=(0,e.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(d,P,A){return(0,t.readString)(A.blockSize)(d)}},r]},function(g){var d=(0,t.peekBytes)(2)(g);return d[0]===33&&d[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,t.readBytes)(2)},r]},function(g){var d=(0,t.peekBytes)(2)(g);return d[0]===33&&d[1]===254}),f=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,e.conditional)({gct:(0,t.readArray)(3,function(g,d){return Math.pow(2,d.lsd.gct.size+1)})},function(g,d){return d.lsd.gct.exists}),{frames:(0,e.loop)([i,c,l,o,a],function(g){var d=(0,t.peekByte)()(g);return d===33||d===44})}],m=f;n.default=m})(Xt);var Ie=ae(Xt);const Le=(n,e)=>{const t=new Array(n.length),r=n.length/e,i=function(m,g){const d=n.slice(g*e,(g+1)*e);t.splice.apply(t,[m*e,e].concat(d))},o=[0,4,2,1],a=[8,8,4,2];for(var c=0,l=0;l<4;l++)for(var f=o[l];f<r;f+=a[l])i(f,c),c++;return t},Me=(n,e,t)=>{const o=t;var a,c,l,f,m,g,d,w,P,A,h,I,v,B,T,x;const H=new Array(t),p=new Array(4096),u=new Array(4096),C=new Array(4096+1);for(I=n,c=1<<I,m=c+1,a=c+2,d=-1,f=I+1,l=(1<<f)-1,P=0;P<c;P++)p[P]=0,u[P]=P;var h,w,v,B,x,T;for(h=w=v=B=x=T=0,A=0;A<o;){if(B===0){if(w<f){h+=e[T]<<w,w+=8,T++;continue}if(P=h&l,h>>=f,w-=f,P>a||P==m)break;if(P==c){f=I+1,l=(1<<f)-1,a=c+2,d=-1;continue}if(d==-1){C[B++]=u[P],d=P,v=P;continue}for(g=P,P==a&&(C[B++]=v,P=d);P>c;)C[B++]=u[P],P=p[P];v=u[P]&255,C[B++]=v,a<4096&&(p[a]=d,u[a]=v,a++,(a&l)===0&&a<4096&&(f++,l+=a)),d=g}B--,H[x++]=C[B],A++}for(A=x;A<o;A++)H[A]=0;return H},Fe=n=>{const e=new Uint8Array(n);return Zt(Jt(e),Ie)},Ne=n=>{const e=n.pixels.length,t=new Uint8ClampedArray(e*4);for(var r=0;r<e;r++){const i=r*4,o=n.pixels[r],a=n.colorTable[o];t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=o!==n.transparentIndex?255:0}return t},Oe=(n,e,t)=>{if(!n.image){console.warn("gif frame does not have associated image.");return}const{image:r}=n,i=r.descriptor.width*r.descriptor.height;var o=Me(r.data.minCodeSize,r.data.blocks,i);r.descriptor.lct.interlaced&&(o=Le(o,r.descriptor.width));const a={pixels:o,dims:{top:n.image.descriptor.top,left:n.image.descriptor.left,width:n.image.descriptor.width,height:n.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?a.colorTable=r.lct:a.colorTable=e,n.gce&&(a.delay=(n.gce.delay||10)*10,a.disposalType=n.gce.extras.disposal,n.gce.extras.transparentColorGiven&&(a.transparentIndex=n.gce.transparentColorIndex)),t&&(a.patch=Ne(a)),a},Re=(n,e)=>n.frames.filter(t=>t.image).map(t=>Oe(t,n.gct,e));function Ge(n,e,t){const r=Wt(e),i=n-1;let o=0;switch(t){case J.L:o=et[i][0];break;case J.M:o=et[i][1];break;case J.Q:o=et[i][2];break;case J.H:o=et[i][3];break}return r<=o}function He(n,e){for(var t=1,r=Wt(n),i=0,o=et.length;i<o;i++){var a=0;switch(e){case J.L:a=et[i][0];break;case J.M:a=et[i][1];break;case J.Q:a=et[i][2];break;case J.H:a=et[i][3];break}if(r<=a)break;t++}if(t>et.length)throw new Error("Too long data");return t}function Wt(n){var e=encodeURI(n).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=Number(n)?3:0)}class $e{constructor(e){this.mode=W.MODE_8BIT_BYTE,this.parsedData=[],this.data=e;const t=[];for(let r=0,i=this.data.length;r<i;r++){const o=[],a=this.data.charCodeAt(r);a>65536?(o[0]=240|(a&1835008)>>>18,o[1]=128|(a&258048)>>>12,o[2]=128|(a&4032)>>>6,o[3]=128|a&63):a>2048?(o[0]=224|(a&61440)>>>12,o[1]=128|(a&4032)>>>6,o[2]=128|a&63):a>128?(o[0]=192|(a&1984)>>>6,o[1]=128|a&63):o[0]=a,t.push(o)}this.parsedData=Array.prototype.concat.apply([],t),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(e){for(let t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}}class lt{constructor(e=-1,t=J.L){this.moduleCount=0,this.dataList=[],this.typeNumber=e,this.errorCorrectLevel=t,this.moduleCount=0,this.dataList=[]}addData(e){if(this.typeNumber<=0)this.typeNumber=He(e,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error(`Invalid QR version: ${this.typeNumber}`);if(!Ge(this.typeNumber,e,this.errorCorrectLevel))throw new Error(`Data is too long for QR version: ${this.typeNumber}`)}const t=new $e(e);this.dataList.push(t),this.dataCache=void 0}isDark(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(`${e},${t}`);return this.modules[e][t]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(e,t){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(let r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(let i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=lt.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)}setupPositionProbePattern(e,t){for(let r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(let i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(0<=r&&r<=6&&(i==0||i==6)||0<=i&&i<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=i&&i<=4?this.modules[e+r][t+i]=!0:this.modules[e+r][t+i]=!1)}getBestMaskPattern(){if(Number.isInteger(this.maskPattern)&&Object.values(it).includes(this.maskPattern))return this.maskPattern;let e=0,t=0;for(let r=0;r<8;r++){this.makeImpl(!0,r);const i=L.getLostPoint(this);(r==0||e>i)&&(e=i,t=r)}return t}setupTimingPattern(){for(let e=8;e<this.moduleCount-8;e++)this.modules[e][6]==null&&(this.modules[e][6]=e%2==0);for(let e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)}setupPositionAdjustPattern(){const e=L.getPatternPosition(this.typeNumber);for(let t=0;t<e.length;t++)for(let r=0;r<e.length;r++){const i=e[t],o=e[r];if(this.modules[i][o]==null)for(let a=-2;a<=2;a++)for(let c=-2;c<=2;c++)a==-2||a==2||c==-2||c==2||a==0&&c==0?this.modules[i+a][o+c]=!0:this.modules[i+a][o+c]=!1}}setupTypeNumber(e){const t=L.getBCHTypeNumber(this.typeNumber);for(var r=0;r<18;r++){var i=!e&&(t>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=i}for(var r=0;r<18;r++){var i=!e&&(t>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=i}}setupTypeInfo(e,t){const r=this.errorCorrectLevel<<3|t,i=L.getBCHTypeInfo(r);for(var o=0;o<15;o++){var a=!e&&(i>>o&1)==1;o<6?this.modules[o][8]=a:o<8?this.modules[o+1][8]=a:this.modules[this.moduleCount-15+o][8]=a}for(var o=0;o<15;o++){var a=!e&&(i>>o&1)==1;o<8?this.modules[8][this.moduleCount-o-1]=a:o<9?this.modules[8][15-o-1+1]=a:this.modules[8][15-o-1]=a}this.modules[this.moduleCount-8][8]=!e}mapData(e,t){let r=-1,i=this.moduleCount-1,o=7,a=0;for(let c=this.moduleCount-1;c>0;c-=2)for(c==6&&c--;;){for(let l=0;l<2;l++)if(this.modules[i][c-l]==null){let f=!1;a<e.length&&(f=(e[a]>>>o&1)==1),L.getMask(t,i,c-l)&&(f=!f),this.modules[i][c-l]=f,o--,o==-1&&(a++,o=7)}if(i+=r,i<0||this.moduleCount<=i){i-=r,r=-r;break}}}static createData(e,t,r){const i=ot.getRSBlocks(e,t),o=new ze;for(var a=0;a<r.length;a++){const l=r[a];o.put(l.mode,4),o.put(l.getLength(),L.getLengthInBits(l.mode,e)),l.write(o)}let c=0;for(var a=0;a<i.length;a++)c+=i[a].dataCount;if(o.getLengthInBits()>c*8)throw new Error(`code length overflow. (${o.getLengthInBits()}>${c*8})`);for(o.getLengthInBits()+4<=c*8&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=c*8||(o.put(lt.PAD0,8),o.getLengthInBits()>=c*8));)o.put(lt.PAD1,8);return lt.createBytes(o,i)}static createBytes(e,t){let r=0,i=0,o=0;const a=new Array(t.length),c=new Array(t.length);for(var l=0;l<t.length;l++){const P=t[l].dataCount,A=t[l].totalCount-P;i=Math.max(i,P),o=Math.max(o,A),a[l]=new Array(P);for(var f=0;f<a[l].length;f++)a[l][f]=255&e.buffer[f+r];r+=P;const I=L.getErrorCorrectPolynomial(A),p=new ft(a[l],I.getLength()-1).mod(I);c[l]=new Array(I.getLength()-1);for(var f=0;f<c[l].length;f++){const C=f+p.getLength()-c[l].length;c[l][f]=C>=0?p.get(C):0}}let m=0;for(var f=0;f<t.length;f++)m+=t[f].totalCount;const g=new Array(m);let d=0;for(var f=0;f<i;f++)for(var l=0;l<t.length;l++)f<a[l].length&&(g[d++]=a[l][f]);for(var f=0;f<o;f++)for(var l=0;l<t.length;l++)f<c[l].length&&(g[d++]=c[l][f]);return g}}lt.PAD0=236;lt.PAD1=17;const J={L:1,M:0,Q:3,H:2},W={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},it={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};class L{static getBCHTypeInfo(e){let t=e<<10;for(;L.getBCHDigit(t)-L.getBCHDigit(L.G15)>=0;)t^=L.G15<<L.getBCHDigit(t)-L.getBCHDigit(L.G15);return(e<<10|t)^L.G15_MASK}static getBCHTypeNumber(e){let t=e<<12;for(;L.getBCHDigit(t)-L.getBCHDigit(L.G18)>=0;)t^=L.G18<<L.getBCHDigit(t)-L.getBCHDigit(L.G18);return e<<12|t}static getBCHDigit(e){let t=0;for(;e!=0;)t++,e>>>=1;return t}static getPatternPosition(e){return L.PATTERN_POSITION_TABLE[e-1]}static getMask(e,t,r){switch(e){case it.PATTERN000:return(t+r)%2==0;case it.PATTERN001:return t%2==0;case it.PATTERN010:return r%3==0;case it.PATTERN011:return(t+r)%3==0;case it.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case it.PATTERN101:return t*r%2+t*r%3==0;case it.PATTERN110:return(t*r%2+t*r%3)%2==0;case it.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error(`bad maskPattern:${e}`)}}static getErrorCorrectPolynomial(e){let t=new ft([1],0);for(let r=0;r<e;r++)t=t.multiply(new ft([1,z.gexp(r)],0));return t}static getLengthInBits(e,t){if(1<=t&&t<10)switch(e){case W.MODE_NUMBER:return 10;case W.MODE_ALPHA_NUM:return 9;case W.MODE_8BIT_BYTE:return 8;case W.MODE_KANJI:return 8;default:throw new Error(`mode:${e}`)}else if(t<27)switch(e){case W.MODE_NUMBER:return 12;case W.MODE_ALPHA_NUM:return 11;case W.MODE_8BIT_BYTE:return 16;case W.MODE_KANJI:return 10;default:throw new Error(`mode:${e}`)}else if(t<41)switch(e){case W.MODE_NUMBER:return 14;case W.MODE_ALPHA_NUM:return 13;case W.MODE_8BIT_BYTE:return 16;case W.MODE_KANJI:return 12;default:throw new Error(`mode:${e}`)}else throw new Error(`type:${t}`)}static getLostPoint(e){const t=e.getModuleCount();let r=0;for(var i=0;i<t;i++)for(var o=0;o<t;o++){let l=0;const f=e.isDark(i,o);for(let m=-1;m<=1;m++)if(!(i+m<0||t<=i+m))for(let g=-1;g<=1;g++)o+g<0||t<=o+g||m==0&&g==0||f==e.isDark(i+m,o+g)&&l++;l>5&&(r+=3+l-5)}for(var i=0;i<t-1;i++)for(var o=0;o<t-1;o++){let m=0;e.isDark(i,o)&&m++,e.isDark(i+1,o)&&m++,e.isDark(i,o+1)&&m++,e.isDark(i+1,o+1)&&m++,(m==0||m==4)&&(r+=3)}for(var i=0;i<t;i++)for(var o=0;o<t-6;o++)e.isDark(i,o)&&!e.isDark(i,o+1)&&e.isDark(i,o+2)&&e.isDark(i,o+3)&&e.isDark(i,o+4)&&!e.isDark(i,o+5)&&e.isDark(i,o+6)&&(r+=40);for(var o=0;o<t;o++)for(var i=0;i<t-6;i++)e.isDark(i,o)&&!e.isDark(i+1,o)&&e.isDark(i+2,o)&&e.isDark(i+3,o)&&e.isDark(i+4,o)&&!e.isDark(i+5,o)&&e.isDark(i+6,o)&&(r+=40);let a=0;for(var o=0;o<t;o++)for(var i=0;i<t;i++)e.isDark(i,o)&&a++;return r+=Math.abs(100*a/t/t-50)/5*10,r}}L.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];L.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0;L.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0;L.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1;class z{static glog(e){if(e<1)throw new Error(`glog(${e})`);return z.LOG_TABLE[e]}static gexp(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return z.EXP_TABLE[e]}}z.EXP_TABLE=new Array(256);z.LOG_TABLE=new Array(256);z._constructor=function(){for(var n=0;n<8;n++)z.EXP_TABLE[n]=1<<n;for(var n=8;n<256;n++)z.EXP_TABLE[n]=z.EXP_TABLE[n-4]^z.EXP_TABLE[n-5]^z.EXP_TABLE[n-6]^z.EXP_TABLE[n-8];for(var n=0;n<255;n++)z.LOG_TABLE[z.EXP_TABLE[n]]=n}();class ft{constructor(e,t){if(e.length==null)throw new Error(`${e.length}/${t}`);let r=0;for(;r<e.length&&e[r]==0;)r++;this.num=new Array(e.length-r+t);for(let i=0;i<e.length-r;i++)this.num[i]=e[i+r]}get(e){return this.num[e]}getLength(){return this.num.length}multiply(e){const t=new Array(this.getLength()+e.getLength()-1);for(let r=0;r<this.getLength();r++)for(let i=0;i<e.getLength();i++)t[r+i]^=z.gexp(z.glog(this.get(r))+z.glog(e.get(i)));return new ft(t,0)}mod(e){if(this.getLength()-e.getLength()<0)return this;const t=z.glog(this.get(0))-z.glog(e.get(0)),r=new Array(this.getLength());for(var i=0;i<this.getLength();i++)r[i]=this.get(i);for(var i=0;i<e.getLength();i++)r[i]^=z.gexp(z.glog(e.get(i))+t);return new ft(r,0).mod(e)}}class ot{constructor(e,t){this.totalCount=e,this.dataCount=t}static getRSBlocks(e,t){const r=ot.getRsBlockTable(e,t);if(r==null)throw new Error(`bad rs block @ typeNumber:${e}/errorCorrectLevel:${t}`);const i=r.length/3,o=[];for(let a=0;a<i;a++){const c=r[a*3+0],l=r[a*3+1],f=r[a*3+2];for(let m=0;m<c;m++)o.push(new ot(l,f))}return o}static getRsBlockTable(e,t){switch(t){case J.L:return ot.RS_BLOCK_TABLE[(e-1)*4+0];case J.M:return ot.RS_BLOCK_TABLE[(e-1)*4+1];case J.Q:return ot.RS_BLOCK_TABLE[(e-1)*4+2];case J.H:return ot.RS_BLOCK_TABLE[(e-1)*4+3];default:return}}}ot.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];class ze{constructor(){this.buffer=[],this.length=0}get(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1}put(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)}getLengthInBits(){return this.length}putBit(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}}const et=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];var Ue=100,X=256,Ft=X-1,at=4,qt=16,Tt=1<<qt,Yt=10,At=10,Ke=Tt>>At,je=Tt<<Yt-At,Xe=X>>3,Et=6,Ze=1<<Et,Je=Xe*Ze,Ve=30,Qt=10,yt=1<<Qt,te=8,Nt=1<<te,We=Qt+te,ht=1<<We,Ot=499,Rt=491,Gt=487,ee=503,qe=3*ee;function Ye(n,e){var t,r,i,o,a;function c(){t=[],r=new Int32Array(256),i=new Int32Array(X),o=new Int32Array(X),a=new Int32Array(X>>3);var p,u;for(p=0;p<X;p++)u=(p<<at+8)/X,t[p]=new Float64Array([u,u,u,0]),o[p]=Tt/X,i[p]=0}function l(){for(var p=0;p<X;p++)t[p][0]>>=at,t[p][1]>>=at,t[p][2]>>=at,t[p][3]=p}function f(p,u,C,h,w){t[u][0]-=p*(t[u][0]-C)/yt,t[u][1]-=p*(t[u][1]-h)/yt,t[u][2]-=p*(t[u][2]-w)/yt}function m(p,u,C,h,w){for(var v=Math.abs(u-p),B=Math.min(u+p,X),x=u+1,T=u-1,M=1,s,F;x<B||T>v;)F=a[M++],x<B&&(s=t[x++],s[0]-=F*(s[0]-C)/ht,s[1]-=F*(s[1]-h)/ht,s[2]-=F*(s[2]-w)/ht),T>v&&(s=t[T--],s[0]-=F*(s[0]-C)/ht,s[1]-=F*(s[1]-h)/ht,s[2]-=F*(s[2]-w)/ht)}function g(p,u,C){var h=2147483647,w=h,v=-1,B=v,x,T,M,s,F;for(x=0;x<X;x++)T=t[x],M=Math.abs(T[0]-p)+Math.abs(T[1]-u)+Math.abs(T[2]-C),M<h&&(h=M,v=x),s=M-(i[x]>>qt-at),s<w&&(w=s,B=x),F=o[x]>>At,o[x]-=F,i[x]+=F<<Yt;return o[v]+=Ke,i[v]-=je,B}function d(){var p,u,C,h,w,v,B=0,x=0;for(p=0;p<X;p++){for(C=t[p],w=p,v=C[1],u=p+1;u<X;u++)h=t[u],h[1]<v&&(w=u,v=h[1]);if(h=t[w],p!=w&&(u=h[0],h[0]=C[0],C[0]=u,u=h[1],h[1]=C[1],C[1]=u,u=h[2],h[2]=C[2],C[2]=u,u=h[3],h[3]=C[3],C[3]=u),v!=B){for(r[B]=x+p>>1,u=B+1;u<v;u++)r[u]=p;B=v,x=p}}for(r[B]=x+Ft>>1,u=B+1;u<256;u++)r[u]=Ft}function P(p,u,C){for(var h,w,v,B=1e3,x=-1,T=r[u],M=T-1;T<X||M>=0;)T<X&&(w=t[T],v=w[1]-u,v>=B?T=X:(T++,v<0&&(v=-v),h=w[0]-p,h<0&&(h=-h),v+=h,v<B&&(h=w[2]-C,h<0&&(h=-h),v+=h,v<B&&(B=v,x=w[3])))),M>=0&&(w=t[M],v=u-w[1],v>=B?M=-1:(M--,v<0&&(v=-v),h=w[0]-p,h<0&&(h=-h),v+=h,v<B&&(h=w[2]-C,h<0&&(h=-h),v+=h,v<B&&(B=v,x=w[3]))));return x}function A(){var p,u=n.length,C=30+(e-1)/3,h=u/(3*e),w=~~(h/Ue),v=yt,B=Je,x=B>>Et;for(x<=1&&(x=0),p=0;p<x;p++)a[p]=v*((x*x-p*p)*Nt/(x*x));var T;u<qe?(e=1,T=3):u%Ot!==0?T=3*Ot:u%Rt!==0?T=3*Rt:u%Gt!==0?T=3*Gt:T=3*ee;var M,s,F,b,N=0;for(p=0;p<h;)if(M=(n[N]&255)<<at,s=(n[N+1]&255)<<at,F=(n[N+2]&255)<<at,b=g(M,s,F),f(v,b,M,s,F),x!==0&&m(x,b,M,s,F),N+=T,N>=u&&(N-=u),p++,w===0&&(w=1),p%w===0)for(v-=v/C,B-=B/Ve,x=B>>Et,x<=1&&(x=0),b=0;b<x;b++)a[b]=v*((x*x-b*b)*Nt/(x*x))}function I(){c(),A(),l(),d()}this.buildColormap=I;function H(){for(var p=[],u=[],C=0;C<X;C++)u[t[C][3]]=C;for(var h=0,w=0;w<X;w++){var v=u[w];p[h++]=t[v][0],p[h++]=t[v][1],p[h++]=t[v][2]}return p}this.getColormap=H,this.lookupRGB=P}var Ht=-1,bt=12,pt=5003,Qe=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function tr(n,e,t,r){var i=Math.max(2,r),o=new Uint8Array(256),a=new Int32Array(pt),c=new Int32Array(pt),l,f=0,m,g=0,d,P=!1,A,I,H,p,u,C;function h(b,N){o[m++]=b,m>=254&&T(N)}function w(b){v(pt),g=I+2,P=!0,F(I,b)}function v(b){for(var N=0;N<b;++N)a[N]=-1}function B(b,N){var y,ut,$,Y,nt,U,Q;for(A=b,P=!1,C=A,d=M(C),I=1<<b-1,H=I+1,g=I+2,m=0,Y=s(),Q=0,y=pt;y<65536;y*=2)++Q;Q=8-Q,U=pt,v(U),F(I,N);t:for(;(ut=s())!=Ht;){if(y=(ut<<bt)+Y,$=ut<<Q^Y,a[$]===y){Y=c[$];continue}else if(a[$]>=0){nt=U-$,$===0&&(nt=1);do if(($-=nt)<0&&($+=U),a[$]===y){Y=c[$];continue t}while(a[$]>=0)}F(Y,N),Y=ut,g<1<<bt?(c[$]=g++,a[$]=y):w(N)}F(Y,N),F(H,N)}function x(b){b.writeByte(i),p=n*e,u=0,B(i+1,b),b.writeByte(0)}function T(b){m>0&&(b.writeByte(m),b.writeBytes(o,0,m),m=0)}function M(b){return(1<<b)-1}function s(){if(p===0)return Ht;--p;var b=t[u++];return b&255}function F(b,N){for(l&=Qe[f],f>0?l|=b<<f:l=b,f+=C;f>=8;)h(l&255,N),l>>=8,f-=8;if((g>d||P)&&(P?(d=M(C=A),P=!1):(++C,C==bt?d=1<<bt:d=M(C))),b==H){for(;f>0;)h(l&255,N),l>>=8,f-=8;T(N)}}this.encode=x}function V(){this.page=-1,this.pages=[],this.newPage()}V.pageSize=4096;V.charMap={};for(var wt=0;wt<256;wt++)V.charMap[wt]=String.fromCharCode(wt);V.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(V.pageSize),this.cursor=0};V.prototype.getData=function(){for(var n="",e=0;e<this.pages.length;e++)for(var t=0;t<V.pageSize;t++)n+=V.charMap[this.pages[e][t]];return n};V.prototype.toFlattenUint8Array=function(){const n=[];for(var e=0;e<this.pages.length;e++)if(e===this.pages.length-1){const r=Uint8Array.from(this.pages[e].slice(0,this.cursor));n.push(r)}else n.push(this.pages[e]);const t=new Uint8Array(n.reduce((r,i)=>r+i.length,0));return n.reduce((r,i)=>(t.set(i,r),r+i.length),0),t};V.prototype.writeByte=function(n){this.cursor>=V.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=n};V.prototype.writeUTFBytes=function(n){for(var e=n.length,t=0;t<e;t++)this.writeByte(n.charCodeAt(t))};V.prototype.writeBytes=function(n,e,t){for(var r=t||n.length,i=e||0;i<r;i++)this.writeByte(n[i])};function O(n,e){this.width=~~n,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new V}O.prototype.setDelay=function(n){this.delay=Math.round(n/10)};O.prototype.setFrameRate=function(n){this.delay=Math.round(100/n)};O.prototype.setDispose=function(n){n>=0&&(this.dispose=n)};O.prototype.setRepeat=function(n){this.repeat=n};O.prototype.setTransparent=function(n){this.transparent=n};O.prototype.addFrame=function(n){this.image=n,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};O.prototype.finish=function(){this.out.writeByte(59)};O.prototype.setQuality=function(n){n<1&&(n=1),this.sample=n};O.prototype.setDither=function(n){n===!0&&(n="FloydSteinberg"),this.dither=n};O.prototype.setGlobalPalette=function(n){this.globalPalette=n};O.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};O.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};O.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new Ye(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};O.prototype.indexPixels=function(n){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var t=0,r=0;r<e;r++){var i=this.findClosestRGB(this.pixels[t++]&255,this.pixels[t++]&255,this.pixels[t++]&255);this.usedEntry[i]=!0,this.indexedPixels[r]=i}};O.prototype.ditherPixels=function(n,e){var t={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!n||!t[n])throw"Unknown dithering kernel: "+n;var r=t[n],i=0,o=this.height,a=this.width,c=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var f=0;f<o;f++){e&&(l=l*-1);for(var m=l==1?0:a-1,g=l==1?a:0;m!==g;m+=l){i=f*a+m;var d=i*3,P=c[d],A=c[d+1],I=c[d+2];d=this.findClosestRGB(P,A,I),this.usedEntry[d]=!0,this.indexedPixels[i]=d,d*=3;for(var H=this.colorTab[d],p=this.colorTab[d+1],u=this.colorTab[d+2],C=P-H,h=A-p,w=I-u,v=l==1?0:r.length-1,B=l==1?r.length:0;v!==B;v+=l){var x=r[v][1],T=r[v][2];if(x+m>=0&&x+m<a&&T+f>=0&&T+f<o){var M=r[v][0];d=i+x+T*a,d*=3,c[d]=Math.max(0,Math.min(255,c[d]+C*M)),c[d+1]=Math.max(0,Math.min(255,c[d+1]+h*M)),c[d+2]=Math.max(0,Math.min(255,c[d+2]+w*M))}}}}};O.prototype.findClosest=function(n,e){return this.findClosestRGB((n&16711680)>>16,(n&65280)>>8,n&255,e)};O.prototype.findClosestRGB=function(n,e,t,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(n,e,t);for(var i=0,o=256*256*256,a=this.colorTab.length,c=0,l=0;c<a;l++){var f=n-(this.colorTab[c++]&255),m=e-(this.colorTab[c++]&255),g=t-(this.colorTab[c++]&255),d=f*f+m*m+g*g;(!r||this.usedEntry[l])&&d<o&&(o=d,i=l)}return i};O.prototype.getImagePixels=function(){var n=this.width,e=this.height;this.pixels=new Uint8Array(n*e*3);for(var t=this.image,r=0,i=0,o=0;o<e;o++)for(var a=0;a<n;a++)this.pixels[i++]=t[r++],this.pixels[i++]=t[r++],this.pixels[i++]=t[r++],r++};O.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var n,e;this.transparent===null?(n=0,e=0):(n=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|n),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};O.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};O.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};O.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};O.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var n=3*256-this.colorTab.length,e=0;e<n;e++)this.out.writeByte(0)};O.prototype.writeShort=function(n){this.out.writeByte(n&255),this.out.writeByte(n>>8&255)};O.prototype.writePixels=function(){var n=new tr(this.width,this.height,this.indexedPixels,this.colorDepth);n.encode(this.out)};O.prototype.stream=function(){return this.out};var er=globalThis&&globalThis.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function c(m){try{f(r.next(m))}catch(g){a(g)}}function l(m){try{f(r.throw(m))}catch(g){a(g)}}function f(m){m.done?o(m.value):i(m.value).then(c,l)}f((r=r.apply(n,e||[])).next())})};const Bt=.4;function $t(n){if(!n)return;function e(t){t.onload=null,t.onerror=null}return new Promise(function(t,r){if(n.slice(0,4)=="data"){let o=new Image;o.onload=function(){t(o),e(o)},o.onerror=function(){r("Image load error"),e(o)},o.src=n;return}let i=new Image;i.setAttribute("crossOrigin","Anonymous"),i.onload=function(){t(i)},i.onerror=function(){r("Image load error")},i.src=n})}class D{constructor(e){const t=Object.assign({},e);if(Object.keys(D.defaultOptions).forEach(r=>{r in t||Object.defineProperty(t,r,{value:D.defaultOptions[r],enumerable:!0,writable:!0})}),t.components?typeof t.components=="object"&&Object.keys(D.defaultComponentOptions).forEach(r=>{r in t.components?Object.defineProperty(t.components,r,{value:Object.assign(Object.assign({},D.defaultComponentOptions[r]),t.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(t.components,r,{value:D.defaultComponentOptions[r],enumerable:!0,writable:!0})}):t.components=D.defaultComponentOptions,t.dotScale!==null&&t.dotScale!==void 0){if(t.dotScale<=0||t.dotScale>1)throw new Error("dotScale should be in range (0, 1].");t.components.data.scale=t.dotScale,t.components.timing.scale=t.dotScale,t.components.alignment.scale=t.dotScale}this.options=t,this.canvas=rt(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new lt(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}draw(){return new Promise(e=>this._draw().then(e))}_clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}static _prepareRoundedCornerClip(e,t,r,i,o,a){e.beginPath(),e.moveTo(t,r),e.arcTo(t+i,r,t+i,r+o,a),e.arcTo(t+i,r+o,t,r+o,a),e.arcTo(t,r+o,t,r,a),e.arcTo(t,r,t+i,r,a),e.closePath()}static _getAverageRGB(e){const r={r:0,g:0,b:0};let i,o,a=-4;const c={r:0,g:0,b:0};let l=0;o=e.naturalHeight||e.height,i=e.naturalWidth||e.width;const m=rt(i,o).getContext("2d");if(!m)return r;m.drawImage(e,0,0);let g;try{g=m.getImageData(0,0,i,o)}catch{return r}for(;(a+=5*4)<g.data.length;)g.data[a]>200||g.data[a+1]>200||g.data[a+2]>200||(++l,c.r+=g.data[a],c.g+=g.data[a+1],c.b+=g.data[a+2]);return c.r=~~(c.r/l),c.g=~~(c.g/l),c.b=~~(c.b/l),c}static _drawDot(e,t,r,i,o=0,a=1){e.fillRect((t+o)*i,(r+o)*i,a*i,a*i)}static _drawAlignProtector(e,t,r,i){e.clearRect((t-2)*i,(r-2)*i,5*i,5*i),e.fillRect((t-2)*i,(r-2)*i,5*i,5*i)}static _drawAlign(e,t,r,i,o=0,a=1,c,l){const f=e.fillStyle;e.fillStyle=c,new Array(4).fill(0).map((m,g)=>{D._drawDot(e,t-2+g,r-2,i,o,a),D._drawDot(e,t+2,r-2+g,i,o,a),D._drawDot(e,t+2-g,r+2,i,o,a),D._drawDot(e,t-2,r+2-g,i,o,a)}),D._drawDot(e,t,r,i,o,a),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map((m,g)=>{D._drawDot(e,t-1+g,r-1,i,o,a),D._drawDot(e,t+1,r-1+g,i,o,a),D._drawDot(e,t+1-g,r+1,i,o,a),D._drawDot(e,t-1,r+1-g,i,o,a)})),e.fillStyle=f}_draw(){var e,t,r,i,o,a,c,l,f,m,g,d,P,A,I,H,p,u,C;return er(this,void 0,void 0,function*(){const h=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,w=this.options.size;let v=this.options.margin;(v<0||v*2>=w)&&(v=0);const B=Math.ceil(v),x=w-2*v,T=this.options.whiteMargin,M=this.options.backgroundDimming,s=Math.ceil(x/h),F=s*h,b=F+2*B,N=rt(b,b),y=N.getContext("2d");this._clear(),y.save(),y.translate(B,B);const ut=rt(b,b),$=ut.getContext("2d");let Y=null,nt=[];if(this.options.gifBackground){const k=Fe(this.options.gifBackground);if(Y=k,nt=Re(k,!0),this.options.autoColor){let E=0,S=0,_=0,j=0;for(let R=0;R<nt[0].colorTable.length;R++){const G=nt[0].colorTable[R];G[0]>200||G[1]>200||G[2]>200||G[0]===0&&G[1]===0&&G[2]===0||(j++,E+=G[0],S+=G[1],_+=G[2])}E=~~(E/j),S=~~(S/j),_=~~(_/j),this.options.colorDark=`rgb(${E},${S},${_})`}}else if(this.options.backgroundImage){const k=yield $t(this.options.backgroundImage);if(this.options.autoColor){const E=D._getAverageRGB(k);this.options.colorDark=`rgb(${E.r},${E.g},${E.b})`}$.drawImage(k,0,0,k.width,k.height,0,0,b,b),$.rect(0,0,b,b),$.fillStyle=M,$.fill()}else $.rect(0,0,b,b),$.fillStyle=this.options.colorLight,$.fill();const U=L.getPatternPosition(this.qrCode.typeNumber),Q=((r=(t=this.options.components)===null||t===void 0?void 0:t.data)===null||r===void 0?void 0:r.scale)||Bt,_t=(1-Q)*.5;for(let k=0;k<h;k++)for(let E=0;E<h;E++){const S=this.qrCode.isDark(k,E),_=E<8&&(k<8||k>=h-8)||E>=h-8&&k<8,j=k==6&&E>=8&&E<=h-8||E==6&&k>=8&&k<=h-8;let R=_||j;for(let Z=1;Z<U.length-1;Z++)R=R||k>=U[Z]-2&&k<=U[Z]+2&&E>=U[Z]-2&&E<=U[Z]+2;const G=E*s+(R?0:_t*s),tt=k*s+(R?0:_t*s);if(y.strokeStyle=S?this.options.colorDark:this.options.colorLight,y.lineWidth=.5,y.fillStyle=S?this.options.colorDark:this.options.colorLight,U.length===0)R||y.fillRect(G,tt,(R?1:Q)*s,(R?1:Q)*s);else{const Z=E<h-4&&E>=h-4-5&&k<h-4&&k>=h-4-5;!R&&!Z&&y.fillRect(G,tt,(R?1:Q)*s,(R?1:Q)*s)}}const q=U[U.length-1],re=this.options.colorLight;if(y.fillStyle=re,y.fillRect(0,0,8*s,8*s),y.fillRect(0,(h-8)*s,8*s,8*s),y.fillRect((h-8)*s,0,8*s,8*s),!((o=(i=this.options.components)===null||i===void 0?void 0:i.timing)===null||o===void 0)&&o.protectors&&(y.fillRect(8*s,6*s,(h-8-8)*s,s),y.fillRect(6*s,8*s,s,(h-8-8)*s)),!((c=(a=this.options.components)===null||a===void 0?void 0:a.cornerAlignment)===null||c===void 0)&&c.protectors&&D._drawAlignProtector(y,q,q,s),!((f=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||f===void 0)&&f.protectors)for(let k=0;k<U.length;k++)for(let E=0;E<U.length;E++){const S=U[E],_=U[k];if(!(S===6&&(_===6||_===q))){if(_===6&&(S===6||S===q))continue;if(S===q&&_===q)continue;D._drawAlignProtector(y,S,_,s)}}y.fillStyle=this.options.colorDark,y.fillRect(0,0,7*s,s),y.fillRect((h-7)*s,0,7*s,s),y.fillRect(0,6*s,7*s,s),y.fillRect((h-7)*s,6*s,7*s,s),y.fillRect(0,(h-7)*s,7*s,s),y.fillRect(0,(h-7+6)*s,7*s,s),y.fillRect(0,0,s,7*s),y.fillRect(6*s,0,s,7*s),y.fillRect((h-7)*s,0,s,7*s),y.fillRect((h-7+6)*s,0,s,7*s),y.fillRect(0,(h-7)*s,s,7*s),y.fillRect(6*s,(h-7)*s,s,7*s),y.fillRect(2*s,2*s,3*s,3*s),y.fillRect((h-7+2)*s,2*s,3*s,3*s),y.fillRect(2*s,(h-7+2)*s,3*s,3*s);const xt=((g=(m=this.options.components)===null||m===void 0?void 0:m.timing)===null||g===void 0?void 0:g.scale)||Bt,St=(1-xt)*.5;for(let k=0;k<h-8;k+=2)D._drawDot(y,8+k,6,s,St,xt),D._drawDot(y,6,8+k,s,St,xt);const Dt=((P=(d=this.options.components)===null||d===void 0?void 0:d.cornerAlignment)===null||P===void 0?void 0:P.scale)||Bt,ie=(1-Dt)*.5;D._drawAlign(y,q,q,s,ie,Dt,this.options.colorDark,((I=(A=this.options.components)===null||A===void 0?void 0:A.cornerAlignment)===null||I===void 0?void 0:I.protectors)||!1);const It=((p=(H=this.options.components)===null||H===void 0?void 0:H.alignment)===null||p===void 0?void 0:p.scale)||Bt,oe=(1-It)*.5;for(let k=0;k<U.length;k++)for(let E=0;E<U.length;E++){const S=U[E],_=U[k];if(!(S===6&&(_===6||_===q))){if(_===6&&(S===6||S===q))continue;if(S===q&&_===q)continue;D._drawAlign(y,S,_,s,oe,It,this.options.colorDark,((C=(u=this.options.components)===null||u===void 0?void 0:u.alignment)===null||C===void 0?void 0:C.protectors)||!1)}}if(T&&(y.fillStyle=this.options.backgroundColor,y.fillRect(-B,-B,b,B),y.fillRect(-B,F,b,B),y.fillRect(F,-B,B,b),y.fillRect(-B,-B,B,b)),this.options.logoImage){const k=yield $t(this.options.logoImage);let E=this.options.logoScale,S=this.options.logoMargin,_=this.options.logoCornerRadius;(E<=0||E>=1)&&(E=.2),S<0&&(S=0),_<0&&(_=0);const j=F*E,R=.5*(b-j),G=R;y.restore(),y.fillStyle=this.options.logoBackgroundColor,y.save(),D._prepareRoundedCornerClip(y,R-S,G-S,j+2*S,j+2*S,_+S),y.clip();const tt=y.globalCompositeOperation;y.globalCompositeOperation="destination-out",y.fill(),y.globalCompositeOperation=tt,y.restore(),y.save(),D._prepareRoundedCornerClip(y,R,G,j,j,_),y.clip(),y.drawImage(k,R,G,j,j),y.restore(),y.save(),y.translate(B,B)}if(Y){let k,E,S,_,j,R;if(nt.forEach(function(G){k||(k=new O(w,w),k.setDelay(G.delay),k.setRepeat(0));const{width:tt,height:Z}=G.dims;E||(E=rt(tt,Z),S=E.getContext("2d"),S.rect(0,0,E.width,E.height),S.fillStyle="#ffffff",S.fill()),(!_||!R||tt!==_.width||Z!==_.height)&&(_=rt(tt,Z),j=_.getContext("2d"),R=j.createImageData(tt,Z)),R.data.set(G.patch),j.putImageData(R,0,0),S.drawImage(_,G.dims.left,G.dims.top);const vt=rt(b,b),dt=vt.getContext("2d");dt.drawImage(E,0,0,b,b),dt.rect(0,0,b,b),dt.fillStyle=M,dt.fill(),dt.drawImage(N,0,0,b,b);const Pt=rt(w,w),Lt=Pt.getContext("2d");Lt.drawImage(vt,0,0,w,w),k.addFrame(Lt.getImageData(0,0,Pt.width,Pt.height).data)}),!k)throw new Error("No frames.");if(k.finish(),zt(this.canvas)){const tt=k.stream().toFlattenUint8Array().reduce((Z,vt)=>Z+String.fromCharCode(vt),"");return Promise.resolve(`data:image/gif;base64,${window.btoa(tt)}`)}return Promise.resolve(Buffer.from(k.stream().toFlattenUint8Array()))}else{$.drawImage(N,0,0,b,b),y.drawImage(ut,-B,-B,b,b);const k=rt(w,w);return k.getContext("2d").drawImage(N,0,0,w,w),this.canvas=k,zt(this.canvas)?Promise.resolve(this.canvas.toDataURL()):Promise.resolve(this.canvas.toBuffer())}})}}D.CorrectLevel=J;D.defaultComponentOptions={data:{scale:.4},timing:{scale:.5,protectors:!1},alignment:{scale:.5,protectors:!1},cornerAlignment:{scale:.5,protectors:!0}};D.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"rgba(255, 255, 255, 0.6)",correctLevel:J.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:D.defaultComponentOptions,autoColor:!0,logoBackgroundColor:"#ffffff",backgroundColor:"#ffffff"};function zt(n){try{return n instanceof HTMLElement}catch{return typeof n=="object"&&n.nodeType===1&&typeof n.style=="object"&&typeof n.ownerDocument=="object"}}const rr={props:{text:{type:String,required:!0},qid:{type:String},correctLevel:{type:Number,default:1},size:{type:Number,default:200},margin:{type:Number,default:20},colorDark:{type:String,default:"#000000"},colorLight:{type:String,default:"#FFFFFF"},bgSrc:{type:String,default:void 0},background:{type:String,default:"rgba(0,0,0,0)"},backgroundDimming:{type:String,default:"rgba(0,0,0,0)"},logoSrc:{type:String,default:void 0},logoBackgroundColor:{type:String,default:"rgba(255,255,255,1)"},gifBgSrc:{type:String,default:void 0},logoScale:{type:Number,default:.2},logoMargin:{type:Number,default:0},logoCornerRadius:{type:Number,default:8},whiteMargin:{type:[Boolean,String],default:!0},dotScale:{type:Number,default:1},autoColor:{type:[Boolean,String],default:!0},binarize:{type:[Boolean,String],default:!1},binarizeThreshold:{type:Number,default:128},callback:{type:Function,default:function(){}},bindElement:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#FFFFFF"},components:{default:function(){return{data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}}}}},name:"vue-qr",data(){return{imgUrl:""}},watch:{$props:{deep:!0,handler(){this.main()}}},mounted(){this.main()},methods:{async main(){if(this.gifBgSrc){const t=await we(this.gifBgSrc),r=this.logoSrc;this.render(void 0,r,t);return}const n=this.bgSrc,e=this.logoSrc;this.render(n,e)},async render(n,e,t){const r=this;new D({gifBackground:t,text:r.text,size:r.size,margin:r.margin,colorDark:r.colorDark,colorLight:r.colorLight,backgroundColor:r.backgroundColor,backgroundImage:n,backgroundDimming:r.backgroundDimming,logoImage:e,logoScale:r.logoScale,logoBackgroundColor:r.logoBackgroundColor,correctLevel:r.correctLevel,logoMargin:r.logoMargin,logoCornerRadius:r.logoCornerRadius,whiteMargin:kt(r.whiteMargin),dotScale:r.dotScale,autoColor:kt(r.autoColor),binarize:kt(r.binarize),binarizeThreshold:r.binarizeThreshold,components:r.components}).draw().then(i=>{this.imgUrl=i,r.callback&&r.callback(i,r.qid)})}}},ir=["src"];function or(n,e,t,r,i,o){return t.bindElement?(Ut(),Kt("img",{key:0,style:{display:"inline-block"},src:i.imgUrl},null,8,ir)):jt("",!0)}var nr=ye(rr,[["render",or]]),ar="assets/SBP_logo.641c3b16.svg";const sr={key:0,class:"content-wrapper sbp"},lr={class:"sbp-qrCode-container"},cr=["href"],ur={class:"sbpTips"},hr={class:"sbpSubTips"},fr={class:"sbp-check-result-container"},dr=st("img",{class:"angle-right",src:ne},null,-1),br={setup(n){const{checkPaymentState:e,paymentState:t,requestPaymentState:r}=se(),{accept:i,decline:o}=me(),{qrCodeSize:a}=window.settings,{globalLoaderHide:c,globalLoaderShow:l}=pe(),{apiErrorHandlerOn:f,apiErrorHandlerOff:m}=le(),g=ce(),d=ue(()=>{var u,C;return(u=g.params)!=null&&u.payment?JSON.parse(g.params.payment):(C=t.value)==null?void 0:C.payment}),P=a||Mt.SIZE_256;function A(u){screen.width>Mt.SIZE_679&&u.preventDefault()}async function I(){l();const u=g.hash.slice(1);t.value=await i(u,{}),await e(t.value,u)}async function H(){l();const u=g.hash.slice(1);t.value=await o(u),await e(t.value,u)}const p=async u=>{u.error===ve.UNEXPECTED_REQUEST&&await r()};return he(async()=>{c(),f(p),be(t)}),fe(()=>{m()}),(u,C)=>gt(d)?(Ut(),Kt("div",sr,[st("div",lr,[st("a",{href:gt(d).options.sbpPayload,onClick:A},[de(nr,{"logo-src":gt(ar),"logo-scale":2,"logo-corner-radius":0,"dot-scale":1,margin:0,text:gt(d).options.sbpPayload,size:gt(P),"color-dark":"#1B1636","color-light":"#ffffff"},null,8,["logo-src","text","size"])],8,cr),st("div",ur,mt(u.$t("pages.sbp.sbpSubtitle")),1),st("div",hr,mt(u.$t("pages.sbp.pressQr")),1),st("button",{class:"btn btn-cancel",onClick:H},mt(u.$t("ui.btn.cancel")),1)]),st("div",fr,[st("button",{id:"submitBtn",class:"btn check-result",onClick:I},[ge(mt(u.$t("ui.btn.checkResult"))+" ",1),dr])])])):jt("",!0)}};export{br as default};
